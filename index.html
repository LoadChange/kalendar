<!doctype html>
<html lang="zh_CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="KALENDAR">
    <meta name="author" content="LoadChange">
    <title>Checkout example for Bootstrap</title>
    <link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">
    <style>
        td {
            cursor: pointer;
            user-select: none;
        }

        td:hover {
            opacity: .7;
        }

        .table {
            min-height: 400px;
        }
    </style>
</head>

<body class="bg-light">

<div class="container">
    <div class="py-5 text-center">
        <h2>Kalendar Demo</h2>
        <p class="lead">Kalendar can quickly build a complex calendar that can be applied to many scenarios, such as:
            tourist attraction ticket booking, plane ticket booking, train ticket booking, room hotel booking, etc.
            Below is a ticket price to demonstrate the power of Kalendar.</p>
    </div>

    <div class="row">
        <div class="col-md-4 order-md-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
                <span class="text-muted">Ticket details</span>
            </h4>
            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between lh-condensed">
                    <div>
                        <h6 class="my-0">Standard tickets</h6>
                        <small class="text-muted">Adult tickets</small>
                    </div>
                    <span class="text-muted">$12</span>
                </li>
                <li class="list-group-item d-flex justify-content-between lh-condensed">
                    <div>
                        <h6 class="my-0">Children ticket</h6>
                        <small class="text-muted">The height is under 120 cm</small>
                    </div>
                    <span class="text-muted">$8</span>
                </li>
                <li class="list-group-item d-flex justify-content-between lh-condensed">
                    <div>
                        <h6 class="my-0">Tickets for elderly</h6>
                        <small class="text-muted">Older than 65</small>
                    </div>
                    <span class="text-muted">$51</span>
                </li>
                <li class="list-group-item d-flex justify-content-between bg-light">
                    <div class="text-success">
                        <h6 class="my-0">Premium holiday</h6>
                        <small>On weekdays</small>
                    </div>
                    <span class="text-success">-$5</span>
                </li>
            </ul>
        </div>
        <div class="col-md-8 order-md-1">
            <h4 class="mb-3">Date selection</h4>
            <table class="table table-dark">
                <thead>
                <tr align="center">
                    <td colspan="2" id="previous">Previous</td>
                    <td colspan="3" id="month-text"></td>
                    <td colspan="2" id="next">Next</td>
                </tr>
                <tr align="center">
                    <td>日</td>
                    <td>一</td>
                    <td>二</td>
                    <td>三</td>
                    <td>四</td>
                    <td>五</td>
                    <td>六</td>
                </tr>
                </thead>
                <tbody id="main-body"></tbody>
            </table>
        </div>
    </div>

    <footer class="my-5 pt-5 text-muted text-center text-small">
        <p class="mb-1">&copy; 2017-2018 kalendar</p>
        <ul class="list-inline">
            <li class="list-inline-item"><a href="#">GitHub</a></li>
            <li class="list-inline-item"><a href="#">NPM</a></li>
            <li class="list-inline-item"><a href="#">Introduce</a></li>
        </ul>
    </footer>
</div>

<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.slim.min.js"></script>
<script src="./dist/kalendar.js"></script>
<script>
    var unifiedMount = {
        price: 550,
        bg: 'info'
    }
    var date = new Date()
    var mount = {}
    var testKey = `${date.getFullYear()}-${(date.getMonth() < 9) ? '0' : ''}${date.getMonth() + 1}-`
    mount[`${testKey}15`] = {flow: 'high'}
    mount[`${testKey}16`] = {flow: 'high'}
    mount[`${testKey}20`] = {flow: 'high'}
    mount[`${testKey}24`] = {flow: 'high'}
    var tbody = document.getElementById('main-body')
    var monthText = document.getElementById('month-text')
    var monthTable = Kalendar.monthly({date: date, mount: mount, unifiedMount: unifiedMount})

    function render() {
        var month = date.getMonth() + 1
        monthText.innerHTML = [date.getFullYear(), (month >= 10 ? month : `0${month}`)].join('-')
        var html = []
        monthTable.forEach(week => {
            html.push('<tr align="center">')
            week.forEach(date => {
                let css = []
                const prefix = 'table-'
                if (date) {
                    if (date.bg) css.push(`${prefix}${date.bg}`)
                    if ([0, 6].indexOf(date.day) >= 0) css.push('bg-warning')
                    if (date.flow === 'high') css.push('bg-danger')
                }
                html.push(`<td class="${css.join(' ')}">${date ? (`${date.date}<br />￥${date.price}`) : ''}</td>`)
            })
            html.push('</tr>')
        })
        tbody.innerHTML = html.join('')
    }

    render()

    document.getElementById('previous').onclick = function () {
        date.setMonth(date.getMonth() - 1)
        monthTable = Kalendar.monthly({date: date, mount: mount, unifiedMount: unifiedMount})
        render()
    }

    document.getElementById('next').onclick = function () {
        date.setMonth(date.getMonth() + 1)
        monthTable = Kalendar.monthly({date: date, mount: mount, unifiedMount: unifiedMount})
        render()
    }
</script>

</body>
</html>
