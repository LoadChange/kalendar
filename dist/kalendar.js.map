{"version":3,"file":"kalendar.js","sources":["../src/utils.js","../src/day.js","../src/kalendar.js"],"sourcesContent":["export const getChinaStandard = (date, streamline) => {\n  let month = date.getMonth() + 1;\n  let day = date.getDate();\n  month = `${month < 10 ? '0' : ''}${month}`;\n  day = `${day < 10 ? '0' : ''}${day}`;\n  const arr = streamline ? [date.getFullYear(), month] : [date.getFullYear(), month, day];\n  return arr.join('-');\n};\n\nexport const getMonthDays = (date) => {\n  const year = date.getFullYear();\n  const month = date.getMonth();\n  const leapYear = !(year % 4) && ((year % 100) || !(year % 400));\n  const days = [31, leapYear ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n  return days[month];\n};\n\nexport const getDate = (dateStr) => {\n  const date = new Date();\n  const [year, month] = dateStr.split('-');\n  date.setFullYear(+year);\n  date.setMonth(month - 1, 1);\n  return date;\n};\n\nexport const eraseTime = (timeStamp) => {\n  const date = new Date(timeStamp);\n  date.setHours(0);\n  date.setMinutes(0);\n  date.setSeconds(0);\n  date.setMilliseconds(0);\n  return date.getTime();\n};\n\nexport const calcMonth = date => date.getFullYear() * 12 + date.getMonth() + 1;\n","import * as utils from './utils';\n\nclass Day {\n  constructor(date, extension = {}) {\n    const toDay = utils.eraseTime(new Date().getTime());\n    const timestamp = utils.eraseTime(date.getTime());\n    const dateText = utils.getChinaStandard(date);\n    const assignment = {\n      year: date.getFullYear(),\n      month: date.getMonth(),\n      date: date.getDate(),\n      day: date.getDay(),\n      past: toDay > timestamp,\n      today: toDay === utils.eraseTime(timestamp),\n      dateText,\n      timestamp,\n      ...extension,\n    };\n    Object.keys(assignment).forEach(key => this.set(key, assignment[key]));\n  }\n\n  set(key, val) {\n    this[key] = val;\n  }\n}\n\nexport default Day;\n","import Day from './day';\nimport * as utils from './utils';\n\nclass Kalendar {\n  constructor({ start, end, unifiedMount = {}, mount = {}, weekStart = 0 } = {}) {\n    this.startTime = start;\n    this.endTime = end;\n    this.unifiedMount = unifiedMount;\n    this.mount = mount;\n    this.weekStart = weekStart;\n    return this._create();\n  }\n\n  get startDate() {\n    const date = this.startTime ? utils.getDate(this.startTime) : new Date();\n    date.setDate(1);\n    return date;\n  }\n\n  get endDate() {\n    if (this.endTime) return utils.getDate(this.endTime);\n    const date = this.startDate;\n    date.setMonth(date.getMonth() + 3);\n    return date;\n  }\n\n  _create() {\n    const { startDate, endDate } = this;\n    const table = {};\n    const count = utils.calcMonth(endDate) - utils.calcMonth(startDate);\n    const startTime = utils.eraseTime(startDate.getTime());\n    if (count < 0) return null;\n    let idx = 0;\n    do {\n      const date = new Date(startTime);\n      date.setMonth(date.getMonth() + idx);\n      table[utils.getChinaStandard(date, true)] = Kalendar.monthly({ date, ...this });\n      idx += 1;\n    } while (count > idx);\n    return table;\n  }\n\n  static monthly({ date, mount = {}, unifiedMount = {}, weekStart = 0, continuous }) {\n    date.setDate(1);\n    const monthTable = [];\n    const days = utils.getMonthDays(date);\n    const day = date.getDay();\n    let skip = 0;\n    if (day !== weekStart) skip = (day || 7) - weekStart;\n    for (let i = 0; i < days + skip; i += 7) {\n      const week = [];\n      let num = 7;\n      if (!i && skip) {\n        for (let k = 0; k < skip; k++) {\n          if (continuous) {\n            const agoneDate = new Date(date.valueOf());\n            agoneDate.setDate(agoneDate.getDate() - skip + k);\n            const previousDateText = utils.getChinaStandard(agoneDate);\n            week.push(new Day(agoneDate, Object.assign({}, unifiedMount, mount[previousDateText])));\n          } else {\n            week.push(null);\n          }\n        }\n        num -= skip;\n      }\n      for (let j = 0; j < num; j++) {\n        const dateText = utils.getChinaStandard(date);\n        week.push(new Day(date, Object.assign({}, unifiedMount, mount[dateText])));\n        if (date.getDate() >= days) break;\n        date.setDate(date.getDate() + 1);\n      }\n      const futureDate = new Date(date.valueOf());\n      while (week.length < num) {\n        if (continuous) {\n          futureDate.setDate(futureDate.getDate() + 1);\n          const dateText = utils.getChinaStandard(futureDate);\n          week.push(new Day(futureDate, Object.assign({}, unifiedMount, mount[dateText])));\n        } else {\n          week.push(null);\n        }\n      }\n      monthTable.push(week);\n    }\n    return monthTable;\n  }\n}\n\nexport default Kalendar;\n"],"names":["getChinaStandard","date","streamline","month","getMonth","day","getDate","getFullYear","join","dateStr","Date","split","year","setFullYear","setMonth","eraseTime","timeStamp","setHours","setMinutes","setSeconds","setMilliseconds","getTime","calcMonth","Day","extension","toDay","utils","timestamp","dateText","assignment","getDay","past","today","Object","keys","forEach","key","_this","set","val","start","end","unifiedMount","mount","weekStart","startTime","endTime","this","_create","startDate","endDate","table","count","idx","Kalendar","monthly","setDate","continuous","monthTable","days","skip","i","week","num","k","agoneDate","valueOf","previousDateText","push","assign","j","futureDate","length"],"mappings":"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"}